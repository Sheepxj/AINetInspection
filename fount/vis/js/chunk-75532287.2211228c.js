(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75532287"],{"233e":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"main-wrapper flex-between"},[a("div",{staticClass:"filter-wrap card"},[a("div",{staticClass:"filter-header border-bottom"},[t._v(" 筛选条件 ")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.filterLoading,expression:"filterLoading"}],staticClass:"filter-body"},[a("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"时间选择",name:"2"}},[a("el-radio-group",{on:{input:t.handleTimeChange},model:{value:t.timePicker,callback:function(e){t.timePicker=e},expression:"timePicker"}},[a("el-radio",{ref:"radio",attrs:{label:1}},[t._v("不限")]),a("el-radio",{ref:"radio",attrs:{label:2}},[t._v("今日")]),a("el-radio",{ref:"radio",attrs:{label:3}},[t._v("近3天")]),a("el-radio",{ref:"radio",attrs:{label:4}},[t._v("近7天")]),a("el-radio",{ref:"radio",attrs:{label:5}},[t._v("自定义")])],1),5==t.timePicker?a("div",{staticClass:"selfdefine-date"},[a("el-date-picker",{attrs:{type:"date",placeholder:"开始时间",size:"small","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":t.pickerOptions},on:{change:t.handleStartTimeChange},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),a("el-date-picker",{attrs:{type:"date",placeholder:"结束时间",size:"small","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":t.pickerOptions},on:{change:t.handleEndTimeChange},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}})],1):t._e()],1),1==t.detectTypePicker?a("el-collapse-item",{attrs:{title:"预警类型",name:"3"}},[a("div",{staticClass:"checkbox-group-list"},[t._l(t.alarmTypeList,(function(e,i){return a("div",{key:i,staticClass:"checkbox-group"},[a("el-checkbox",{on:{change:function(e){return t.handleAlarmTypeChange(e,i)}},model:{value:e.checked,callback:function(a){t.$set(e,"checked",a)},expression:"item.checked"}},[t._v(t._s(e.label))]),a("span",{staticClass:"warning-count"},[t._v(t._s(e.value))])],1)})),0==t.alarmTypeList.length?a("el-empty",{attrs:{description:"暂无数据"}}):t._e()],2)]):t._e(),a("el-collapse-item",{attrs:{title:"摄像头点位",name:"4"}},[a("div",{staticClass:"checkbox-group-list"},[t._l(t.loactionList,(function(e,i){return a("div",{key:i,staticClass:"checkbox-group"},[a("el-checkbox",{on:{change:function(e){return t.handleLocationChange(e,i)}},model:{value:e.checked,callback:function(a){t.$set(e,"checked",a)},expression:"item.checked"}},[t._v(t._s(e.label))]),a("span",{staticClass:"warning-count"},[t._v(t._s(e.value))])],1)})),0==t.loactionList.length?a("el-empty",{attrs:{description:"暂无数据"}}):t._e()],2)])],1)],1)]),a("div",{staticClass:"main-content card"},[a("div",{staticClass:"top-action"},[a("div",{staticClass:"search-box"},[a("el-input",{attrs:{placeholder:"请输入多个关键词，用空格隔开",size:"medium"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterList(e)}},model:{value:t.params.searchText,callback:function(e){t.$set(t.params,"searchText",e)},expression:"params.searchText"}})],1)]),a("div",{staticClass:"list-top"},[a("div",{staticClass:"statistics"},[a("div",{staticClass:"search-total"},[t._v("共有"),a("span",{staticClass:"total-count"},[t._v(t._s(t.totalCount))]),t._v("条告警事件")])])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticClass:"search-result"},[a("div",{staticClass:"image-list"},t._l(t.dataList,(function(e,i){return a("div",{key:i,staticClass:"image-item",on:{click:function(a){return t.viewVideo(e)}}},[a("div",{staticClass:"image"},[a("img",{attrs:{src:e.capturedImage,alt:""}})]),a("div",{staticClass:"position"},[a("span",{staticClass:"text-gray label"},[t._v("摄像头点位：")]),a("span",{staticClass:"value"},[t._v(t._s(e.cameraPosition))])]),1==t.detectTypePicker?a("div",{staticClass:"model"},[a("span",{staticClass:"text-gray label"},[t._v("预警类型：")]),a("span",{staticClass:"value"},[t._v(t._s(e.alertType))])]):t._e(),2==t.detectTypePicker?a("div",{staticClass:"content"},[a("span",{staticClass:"text-gray label"},[t._v("预警内容：")]),a("span",{staticClass:"value ",attrs:{title:e.textContent}},[t._v(t._s(e.textContent))])]):t._e(),a("div",{staticClass:"date"},[a("span",{staticClass:"text-gray label"},[t._v("预警时间：")]),a("span",{staticClass:"value"},[t._v(t._s(e.alertTime?e.alertTime.slice(0,16):""))])])])})),0),0==t.dataList.length?a("el-empty",{attrs:{description:"暂无数据"}}):t._e(),t.dataList.length>0?a("el-pagination",{attrs:{"current-page":t.params.pageNum,"page-sizes":[10,20,30,40,50],"page-size":t.params.pageSize,layout:"total, prev, pager, next",total:t.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1)])]),a("el-dialog",{attrs:{title:"告警详情",visible:t.dialogVisible,width:"65%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"dialog-wrap",staticStyle:{"min-height":"360px"}},[a("div",{staticClass:"left-box"},[a("div",{staticClass:"result-item"},[a("span",{staticClass:"result-item-key"},[t._v("摄像头点位：")]),a("span",{staticClass:"result-item-value"},[t._v(t._s(t.alarmInfo.cameraPosition))])]),a("div",{staticClass:"result-item"},[a("span",{staticClass:"result-item-key"},[t._v("监测任务：")]),a("span",{staticClass:"result-item-value"},[t._v(t._s(1==t.detectTypePicker?t.alarmInfo.monitoringTask:t.alarmInfo.ocrTask))])]),1==t.detectTypePicker?a("div",{staticClass:"result-item"},[a("span",{staticClass:"result-item-key"},[t._v("预警类型：")]),a("span",{staticClass:"result-item-value"},[t._v(t._s(t.alarmInfo.alertType))])]):t._e(),2==t.detectTypePicker?a("div",{staticClass:"result-item"},[a("span",{staticClass:"result-item-key"},[t._v("预警内容：")]),a("span",{staticClass:"result-item-value"},[t._v(t._s(t.alarmInfo.textContent))])]):t._e(),a("div",{staticClass:"result-item"},[a("span",{staticClass:"result-item-key"},[t._v("预警时间：")]),a("span",{staticClass:"result-item-value"},[t._v(t._s(t.alarmInfo.alertTime?t.alarmInfo.alertTime.slice(0,16):""))])]),a("div",{staticClass:"result-item"},[a("span",{staticClass:"result-item-key"},[t._v("告警级别：")]),a("span",{staticClass:"result-item-value"},[t._v(t._s(1==t.detectTypePicker?t.alarmInfo.alertLevel:1==t.detectTypePicker?t.alarmInfo.ocrLevel:t.alarmInfo.faceLevel))])])]),a("div",{staticClass:"right-box"},[a("div",{staticClass:"title"},[t._v(t._s(t.alarmInfo.capturedVideo?"摄像头监控截取视频片段":"摄像头监控截图"))]),a("div",{staticClass:"camera-wrap"},[t.alarmInfo.capturedVideo?a("video",{attrs:{src:t.alarmInfo.capturedVideo,poster:t.alarmInfo.capturedImage,controls:"",muted:"",preload:"auto",autoplay:"autoplay",loop:"loop"},domProps:{muted:!0}}):a("img",{directives:[{name:"viewer",rawName:"v-viewer"}],attrs:{src:t.alarmInfo.capturedImage,alt:""}})])])])])],1)},s=[],l=(a("14d9"),a("ccea"));function r(t){return Object(l["a"])({url:"/warningTable/selectwarning",method:"post",data:t})}function n(){return Object(l["a"])({url:"/warningTable/getalertTypes",method:"get"})}function c(){return Object(l["a"])({url:"/warningTable/getcameraPosition",method:"get"})}function o(t){return Object(l["a"])({url:"/warningTable/selectbytaskid",method:"get",params:t})}function d(){return Object(l["a"])({url:"/ocrTable/getcameraPosition",method:"post"})}function m(t){return Object(l["a"])({url:"/ocrTable/getOcrTalbes",method:"post",data:t})}function h(t){return Object(l["a"])({url:"/ocrTable/getOcrTalbe",method:"post",data:t})}function p(){return Object(l["a"])({url:"/faceTable/getcameraPosition",method:"post"})}function u(t){return Object(l["a"])({url:"/faceTable/getOcrTalbes",method:"post",data:t})}function g(t){return Object(l["a"])({url:"/faceTable/getOcrTalbe",method:"post",data:t})}var f=a("b775"),v={components:{},props:{},data(){return{filterLoading:!1,tableLoading:!1,activeNames:["1","3"],detectTypePicker:1,timePicker:1,startTime:"",endTime:"",pickerOptions:{disabledDate(t){return t.getTime()>Date.now()-864e4}},params:{pageNum:1,pageSize:12,searchText:"",alertTypes:[],cameraPosition:[],startTime:"",endTime:""},alarmTypeList:[],loactionList:[],totalCount:0,dataList:[],dialogLoading:!1,dialogVisible:!1,alarmInfo:{alertId:"",alertLevel:"",alertTime:"",alertType:"",cameraPosition:"",capturedImage:"",capturedVideo:"",monitoringTask:""}}},created(){this.initFilterParams(),this.getWarningEvent()},mounted(){},watch:{},computed:{},methods:{initFilterParams(){this.filterLoading=!0;var t=[n(),c()];Promise.all(t).then(t=>{if(200==t[0].code&&Object.keys(t[0].data).length>0){let e=0;for(const a in t[0].data)e+=t[0].data[a];this.alarmTypeList=[{label:"不限",value:e,checked:!0}];for(const a in t[0].data)this.alarmTypeList.push({label:a,value:t[0].data[a],checked:!1})}if(200==t[1].code&&Object.keys(t[1].data).length>0){let e=0;for(const a in t[1].data)e+=t[1].data[a];this.loactionList=[{label:"不限",value:e,checked:!0}];for(const a in t[1].data)this.loactionList.push({label:a,value:t[1].data[a],checked:!1})}}).finally(()=>{this.filterLoading=!1})},getAllAlgorithm(){this.filterLoading=!0,this.alarmTypeList=[],n().then(t=>{if(200==t.code&&Object.keys(t.data).length>0)for(const e in t.data)this.alarmTypeList.push({label:e,value:t.data[e],checked:!1})}).finally(()=>{this.filterLoading=!1})},getAllLocations(){this.filterLoading=!0,c().then(t=>{if(200==t.code&&Object.keys(t.data).length>0){let e=0;for(const a in t.data)e+=t.data[a];this.loactionList=[{label:"不限",value:e,checked:!0}];for(const a in t.data)this.loactionList.push({label:a,value:t.data[a],checked:!1})}}).finally(()=>{this.filterLoading=!1})},getTextDetectLocations(){this.filterLoading=!0,d().then(t=>{if(200==t.code&&Object.keys(t.data).length>0){let e=0;for(const a in t.data)e+=t.data[a];this.loactionList=[{label:"不限",value:e,checked:!0}];for(const a in t.data)this.loactionList.push({label:a,value:t.data[a],checked:!1})}}).finally(()=>{this.filterLoading=!1})},getFaceDetectLocations(){this.filterLoading=!0,p().then(t=>{if(200==t.code&&Object.keys(t.data).length>0){let e=0;for(const a in t.data)e+=t.data[a];this.loactionList=[{label:"不限",value:e,checked:!0}];for(const a in t.data)this.loactionList.push({label:a,value:t.data[a],checked:!1})}}).finally(()=>{this.filterLoading=!1})},getWarningEvent(){if(this.dataList=[],this.tableLoading=!0,1==this.detectTypePicker)r(this.params).then(t=>{200==t.code&&(this.dataList=t.data,this.dataList.forEach(t=>{t.capturedImage=f["a"].split("/api")[0]+t.capturedImage}),this.totalCount=t.count)}).finally(()=>{this.tableLoading=!1});else if(2==this.detectTypePicker){var t={pageNum:this.params.pageNum,pageSize:this.params.pageSize,searchText:this.params.searchText,cameraPosition:this.params.cameraPosition,startDate:this.params.startTime,endDate:this.params.endTime};m(t).then(t=>{200==t.code&&(this.dataList=t.data,this.dataList.forEach(t=>{t.capturedImage=f["a"].split("api")[0]+t.capturedImage}),this.totalCount=t.count)}).finally(()=>{this.tableLoading=!1})}else{t={pageNum:this.params.pageNum,pageSize:this.params.pageSize,faceData:this.params.searchText,cameraPosition:this.params.cameraPosition,startTime:this.params.startTime,endTime:this.params.endTime};u(t).then(t=>{200==t.code&&(this.dataList=t.data,this.dataList.forEach(t=>{t.capturedImage=f["a"].split("/api")[0]+t.capturedImage}),this.totalCount=t.count)}).finally(()=>{this.tableLoading=!1})}},filterList(){this.params.pageNum=1,this.getWarningEvent()},handleAlarmTypeChange(t,e){this.params.alertTypes=[],0==e?t&&this.alarmTypeList.forEach((t,e)=>{0!=e&&t.checked&&(t.checked=!1)}):t&&this.alarmTypeList[0].checked&&(this.alarmTypeList[0].checked=!1),this.alarmTypeList.forEach((t,e)=>{0!=e&&t.checked&&this.params.alertTypes.push(t.label)}),this.filterList()},handleLocationChange(t,e){this.params.cameraPosition=[],0==e?t&&this.loactionList.forEach((t,e)=>{0!=e&&t.checked&&(t.checked=!1)}):t&&this.loactionList[0].checked&&(this.loactionList[0].checked=!1),this.loactionList.forEach((t,e)=>{0!=e&&t.checked&&this.params.cameraPosition.push(t.label)}),this.filterList()},handleDetectTypeChange(t){1==this.detectTypePicker?this.getAllLocations():2==this.detectTypePicker?this.getTextDetectLocations():this.getFaceDetectLocations(),this.params.pageNum=1,this.getWarningEvent()},handleTimeChange(t){if(this.startTime="",this.endTime="",1==t)this.params.startTime="",this.params.endTime="";else if(2==t)this.params.startTime=this.timestampToDate((new Date).getTime()-864e5),this.params.endTime=this.timestampToDate((new Date).getTime());else if(3==t)this.params.startTime=this.timestampToDate((new Date).getTime()-2592e5),this.params.endTime=this.timestampToDate((new Date).getTime());else{if(4!=t)return;this.params.startTime=this.timestampToDate((new Date).getTime()-6048e5),this.params.endTime=this.timestampToDate((new Date).getTime())}this.filterList()},handleStartTimeChange(t){this.startTime&&this.endTime&&(this.checkDate(this.startTime,this.endTime)?(this.params.startTime=this.startTime,this.params.endTime=this.endTime,this.filterList()):(this.endTime="",this.$message.error("结束时间不能早于开始时间")))},handleEndTimeChange(t){this.endTime=this.endTime.slice(0,11)+"23:59:59",this.startTime&&this.endTime&&(this.checkDate(this.startTime,this.endTime)?(this.params.startTime=this.startTime,this.params.endTime=this.endTime,this.filterList()):(this.endTime="",this.$message.error("结束时间不能早于开始时间")))},checkDate(t,e){var a=new Date(t),i=new Date(e);return!(a.getTime()>=i.getTime())},timestampToDate(t){let e=new Date(t),a=e.getFullYear(),i=e.getMonth()+1,s=e.getDate();return a+"-"+(i<10?"0"+i:i)+"-"+(s<10?"0"+s:s)+" "+e.toTimeString().substring(0,8)},setWarning(){this.$router.push("/warning/settings")},viewVideo(t){this.tableLoading=!0,1==this.detectTypePicker?o({alertId:t.alertId}).then(t=>{200==t.code&&(this.dialogVisible=!0,this.alarmInfo=t.data,Object.keys(this.alarmInfo).length>0&&(this.alarmInfo.capturedImage&&(this.alarmInfo.capturedImage=f["a"].split("/api")[0]+this.alarmInfo.capturedImage),this.alarmInfo.capturedVideo&&(this.alarmInfo.capturedVideo=f["a"].split("/api")[0]+this.alarmInfo.capturedVideo)))}).finally(()=>{this.tableLoading=!1}):2==this.detectTypePicker?h({Id:t.id}).then(t=>{200==t.code&&(this.dialogVisible=!0,this.alarmInfo=t.data,Object.keys(this.alarmInfo).length>0&&this.alarmInfo.capturedImage&&(this.alarmInfo.capturedImage=f["a"].split("api")[0]+this.alarmInfo.capturedImage))}).finally(()=>{this.tableLoading=!1}):g({Id:t.id}).then(t=>{200==t.code&&(this.dialogVisible=!0,this.alarmInfo=t.data,Object.keys(this.alarmInfo).length>0&&(this.alarmInfo.capturedImage&&(this.alarmInfo.capturedImage=f["a"].split("/api")[0]+this.alarmInfo.capturedImage),this.alarmInfo.capturedVideo&&(this.alarmInfo.capturedVideo=f["a"].split("/api")[0]+this.alarmInfo.capturedVideo)))}).finally(()=>{this.tableLoading=!1})},handleSizeChange(t){this.params.pageNum=1,this.params.pageSize=t,this.getWarningEvent()},handleCurrentChange(t){this.params.pageNum=t,this.getWarningEvent()}}},T=v,b=(a("ceb1"),a("2877")),k=Object(b["a"])(T,i,s,!1,null,"659dd220",null);e["default"]=k.exports},"2db2":function(t,e,a){},ceb1:function(t,e,a){"use strict";a("2db2")}}]);